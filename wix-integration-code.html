<!-- Anthill IQ Chatbot Widget for Wix -->
<div id="anthill-chat-widget" style="position: fixed; bottom: 20px; right: 20px; z-index: 9999;">
    <!-- Chat Button -->
    <button id="anthill-chat-button" style="
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        cursor: pointer;
        box-shadow: 0 2px 12px rgba(0,0,0,0.15);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        transition: all 0.3s ease;
    ">
        ðŸ’¬
    </button>

    <!-- Chat Window -->
    <div id="anthill-chat-window" style="
        display: none;
        position: fixed;
        bottom: 90px;
        right: 20px;
        width: 350px;
        height: 500px;
        background: white;
        border-radius: 10px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
        overflow: hidden;
        flex-direction: column;
    ">
        <!-- Chat Header -->
        <div style="
            background: #007bff;
            color: white;
            padding: 15px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        ">
            <span>Anthill IQ Assistant</span>
            <button id="anthill-chat-close" style="
                background: none;
                border: none;
                color: white;
                cursor: pointer;
                font-size: 20px;
            ">Ã—</button>
        </div>

        <!-- Chat Messages -->
        <div id="anthill-chat-messages" style="
            flex-grow: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        "></div>

        <!-- Chat Input -->
        <div style="
            padding: 15px;
            border-top: 1px solid #eee;
            display: flex;
            gap: 10px;
        ">
            <input type="text" id="anthill-chat-input" placeholder="Type your message..." style="
                flex-grow: 1;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 20px;
                outline: none;
            ">
            <button id="anthill-chat-send" style="
                background: #007bff;
                color: white;
                border: none;
                border-radius: 20px;
                padding: 10px 20px;
                cursor: pointer;
            ">Send</button>
        </div>
    </div>
</div>

<script>
// Configuration
const CHAT_API_URL = 'https://anthill-chatbot.vercel.app/api/chat';
const WIDGET_ID = 'anthill-chat-widget-' + Math.random().toString(36).substr(2, 9);

// Initialize widget
document.addEventListener('DOMContentLoaded', function() {
    const widget = document.getElementById('anthill-chat-widget');
    const button = document.getElementById('anthill-chat-button');
    const window = document.getElementById('anthill-chat-window');
    const close = document.getElementById('anthill-chat-close');
    const input = document.getElementById('anthill-chat-input');
    const send = document.getElementById('anthill-chat-send');
    const messages = document.getElementById('anthill-chat-messages');

    // Add welcome message
    addMessage('Hello! Welcome to Anthill IQ. How can I help you today?', 'bot');

    // Toggle chat window
    button.addEventListener('click', () => {
        window.style.display = window.style.display === 'none' ? 'flex' : 'none';
    });

    // Close chat window
    close.addEventListener('click', () => {
        window.style.display = 'none';
    });

    // Send message
    function sendMessage() {
        const message = input.value.trim();
        if (!message) return;

        // Add user message
        addMessage(message, 'user');
        input.value = '';

        // Show typing indicator
        const typingId = addMessage('...', 'bot', true);

        // Send to API
        fetch(CHAT_API_URL, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                message: message,
                user_id: WIDGET_ID
            })
        })
        .then(response => response.json())
        .then(data => {
            // Remove typing indicator
            const typingElement = document.getElementById(typingId);
            if (typingElement) {
                typingElement.remove();
            }

            // Add bot response
            if (data.response) {
                addMessage(data.response, 'bot');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            // Remove typing indicator
            const typingElement = document.getElementById(typingId);
            if (typingElement) {
                typingElement.remove();
            }
            // Show error message
            addMessage('Sorry, I encountered an error. Please try again.', 'bot');
        });
    }

    // Add message to chat
    function addMessage(text, sender, isTyping = false) {
        const messageId = 'msg-' + Math.random().toString(36).substr(2, 9);
        const messageDiv = document.createElement('div');
        messageDiv.id = messageId;
        messageDiv.style.cssText = `
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 15px;
            margin-bottom: 10px;
            ${sender === 'user' ? 'margin-left: auto; background: #007bff; color: white;' : 'margin-right: auto; background: #f0f0f0;'}
            ${isTyping ? 'animation: pulse 1.5s infinite;' : ''}
        `;
        messageDiv.textContent = text;
        messages.appendChild(messageDiv);
        messages.scrollTop = messages.scrollHeight;
        return messageId;
    }

    // Send message on button click
    send.addEventListener('click', sendMessage);

    // Send message on Enter key
    input.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            sendMessage();
        }
    });
});

// Add styles
const style = document.createElement('style');
style.textContent = `
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.5; }
        100% { opacity: 1; }
    }
`;
document.head.appendChild(style);
</script>

<!-- 
Method 2: iFrame Integration (Alternative)
Copy and paste the following code into an HTML element in Wix:

<iframe 
    src="https://anthill-chatbot-ghm916hgr-sreekumar-thorsigniaos-projects.vercel.app/iframe.html" 
    width="400" 
    height="600" 
    frameborder="0"
    style="position: fixed; bottom: 20px; right: 20px; border: none; z-index: 9999;">
</iframe>
-->

<!-- 
How to add this to your Wix website:

1. Go to your Wix website editor
2. Click the "+" button to add a new element
3. Search for "HTML iframe" or "Embed" and add it to your page
4. Click on the newly added element and select "Enter code"
5. Paste the code above (either Method 1 or Method 2)
6. Click "Update" and then publish your site
--> 